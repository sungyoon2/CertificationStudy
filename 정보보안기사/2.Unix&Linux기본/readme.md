#Unix&Linux기본
---
시스템 기본
---
> password파일<br>
```
1. 구성<br>
   - 콜론(:)을 구분자로 7개의 필드
      사용자계정명 : 패스워드 : UID : GID : 설명 : 홈 디렉터리 : 로그인 쉘
2. UID<br>
  - 시스템내에서 사용자를 고유하게 식별하기 위한 ID
  - root계정의 UID는 '0'예약
    => 일반 사용자가 UID를 0으로 설정하면 ROOT권한을 가질수 있기에 이에 대해 공격이 발생할 수 있음
    => 주기적으로 점검이 필요
3. GID<br>
  - 모든 사용자는 하나의 기본그룹에 필수적으로 속함
4. 로그인 쉘<br>
  - 로그인에 성공한 후 동작할 쉘프로그램이 설정
  - root그룹은 GID = 0으로 예약
5. 로그인 쉘
  - 쉘 : 사용자와 운영체제(커널)간의 인터페이스 역할, 명령어를 해석하여 커널에 전달하고 그 결과를 출력
  - 로그인 쉘 필드에는 항상 로그인 쉘만 설정할 수 있는 건x -> 이를 악용해 로그인시 악성 쉘이 실행되도록 설정하는 예도 있음.
```
> group파일<br>
```
1. 구성<br>
  - 콜론(:)을 구분자로 4개의 필드
    그룹명 : 그룹패스워드 : GID : 그룹에 소속된 사용자
```
> Password변경<br>
```
1. passwd<br>
  - passwd 명령어를 이용해서 일반 사용자는 자신의 패스워드만 변경가능
  - but, root는 자신을 포함하여 시스템에 등록된 모든 사용자의 패스워드를 변경할 수 있음
```
> Pipe/Pipe line기능<br>
```
- 명령어의 실행 결과를 다른 명령어의 입력으로 전달하여 처리하도록 하는 기능
- '|'의 기호를 사용
```
> 특수문자<br>
```
~ : 홈디렉터리
. : 현재 디렉터리
.. : 상위 디렉터리
$ : 쉘변수
& : 백그라운드 모드로 실행
* : 임의의 0개이상의 문자 대체(와일드 카드)
? : 임의의 1개 문자 대체(와일드 카드)
; : 쉘명령 구분자
| : 파이프
< : 입력 재지정
> : 출력 재지정
```
---
파일 시스템 응용
---
> 부트 블록<br>
- 운영체제를 부팅하거나 초기화하기 위한 부트스트랩코드를 담고 있는 블럭
> 슈퍼 블록<br>
- 파일 시스템을 관리하기 위한 정보를 담고 있는 블록
> inode<br>
- inode에는 파일명이 없으며 파일명은 디렉터리를 통해 관리
- 침해사고 발생시 파일에 대한 무결성확인을 위해 mac time을 점검
```
<inode list>
- inode number : 고유한 식별자
- 파일 타입 : 파일 유형
- 접근권한
- link count : 해당 inode를 참조하는 링크 개수(하드 링크 개수)
- UID
- GID
- 파일 크기
- MAC Time
      - Last Modefication time : 파일의 내용을 마지막으로 수정한 시간
      - Last Access Time : 파일을 마지맏으로 접근한 시간
      - Last Change Time : 파일의 속성을 마지막으로 변경한 시간, 여기서 속성은 inode정보를 의미함
- Block index : 파일데이터에 대한 인텍스 정보
```
- inode정보 -> stat 파일경로(ex. /etc/passwd)
> 하드링크<br>
```
- 기존 파일과 동일한 inode number를 가지는 파일
- 디렉터리는 하드링크가 불가능
- ln [링크시킬 파일이름] [생성될 파일이름]
```
> 심볼릭 링크<br>
```
- 원본 파일에 대한 파일 경로를 파일 내용으로 하는 새로운 파일 생성
- 파일 시스템에 제한이 없으며 디렉터리도 가능
- ln -s [링크시킬 파일이름] [생성될 파일이름]
```
> ls<br>
- list의 약자로 특정 디렉터리에 있는 디렉터리와 파일목록, 옵션으로 여러가지 정보 확인시 사용
```
<옵션>
-l : list형태로 디렉터리 및 파일 정보를 자세히 보여줌(-> 파일종류 및 접근권한, 하드링크개수, 소유자, 소유 그룹, 파일크기, 최종 변경(수정) 일시, 파일명)
-a : 디렉터리에 있는 모든 디렉터리와 파일(숨김 포함)을 보여줌
-R : 하위 디렉터리에 있는 내용까지 보여줌
-F : 파일명 끝에 파일 종류를 기호로 보여줌(디렉터리 : /, 실행파일 : *)
-i : 디렉터리 및 파일에 지정된 inode number를 보여줌
```
> cd<br>
- 파일 시스템내의 특정 디렉터리로 이동시 사용
> mkdir<br>
- 디렉터리를 새로 생성시 사용
> rmdir<br>
- 기존 디렉터리를 삭제시 사용
- 성공을 위해서 하위 디렉터리나 파일이 없어야함
> chmode<br>
- 파일또는 디렉터리에 대한 접근권한을 변경시 사용
```
<기호>
- u(user), g(group), o(other), a(all)
- +(추가), -(제거), =(설정)
- r(읽기), w(쓰기), x(실행)
<숫자>
- r = 4 , w = 2, x = 1
```
> chown<br>
- 파일 또는 디렉터리의 소유자를 변경시 사용
- root권한으로만 실행가능
> chgrp<br>
- 파일 또는 디렉터리의 소유그룹을 변경시 사용
- root권한으로만 실행가능
> umask<br>
- 파일 또는 디렉터리 생성시 접근권한을 설정하기 위해 사용되는 값으로 제거할 접근권한 정보가 설정
```
- 파일 : 기본 접근권한(666)에서 umask권한 제거
- 디렉터리 : 기본 접근권한(777)에서 umask권한 제거
```
- 권장 설정 : /etc/profile 등 시스템 로그인하는 사용자에게 적용되는 환경설정파일에 group과 other에게 쓰기권한을 제거하는 022(0022)이상으로 설정
> find<br>
- 파일 검색
```
find path [   ]  [   ]
- path는 최상위 루트 디렉터리(/)부터 시작하는 절대경로나 현재 디렉터리(.)부터 시작하는 상대경로를 지정할 수 있다.
- [   ]: 검색조건이며, 이는 AND연산(-a), OR연산(-o), NOT연산(!)를 사용한 논리 연산도 가능
       : 연산결과를 하나의 단위로 평가하기위해 소괄호를 사용할수있으며, \(  ~~~  \)이런식으로 사용한다
- -exec 옵션을 통해 검색 결과 파일에 대한 추가적인 명령을 실행할 수 있으며, {}의 의미는 추가적인 명령에 대한 인수를 검색결과 파일로 함을 의미, \;는 명령의 끝을 의미
- -perm 은 접근권한 관련옵션 -> -perm -2 (other에 대한 쓰기 권한을 포함하기 있는 파일), -22(소유그룹과 others에 대한), -222(소유자, 소유그룹, others에 대한)
```
> 명령어 총 정리<br>
```
<디렉터리 관리>
ls : 디렉터리 및 파일 정보를 나열
cd : 작업 디렉터리를 변경
pwd : 현재 작업 디렉터리의 절대경로명을 출력
mkdir : 새로운 디렉터리를 만들 때 사용
rmdir : 비어 있는 디렉터리를 삭제할 때 사용
<파일 관리>
cat : 파일의 내용을 출력하거나 여러 파일의 내용을 병합
more : 파일의 내용을 스크롤하여 출력
head : 파일의 앞부분(디폴트는 앞 열 줄)을 출력
tail : 파일의 뒷부분(디폴트는 마지막 열 줄)을 출력
mv : 파일과 디렉터리를 이동시키거나 파일 이름을 변경
cp : 파일의 내용을 복사하고 새로운 이름을 생성
rm : 파일이나 디렉터리를 삭제
ln : 하드링크 또는 심볼릭 링크 생성
<파일권한 관리>
chmod : 파일이나 디렉터리의 접근권한을 변경
chown : 파일의 소유주를 변경
chgrp : 파일의 소유 그룹을 변경
touch : 0 Byte 파일 생성 또는 파일의 시간을 변경
umask : 파일 생성시 접근권한에 영향을 미침
<파일 응용>
wc : 파일 내 행, 단어, 문자의 수를 출력
cut : 파일의 행으로부터 특정 바이트나 필드를 추출
paste : 파일 내 행을 병합할 때 사용
tr : 파일 내 지정 문자를 치환 또는 삭제할 때 사용
sort : 파일을 정렬할 때 사용
split : 파일을 분할할 때 사용
unip : 파일에서 인접한 행의 내용을 비교
cmp : 파일을 비교할 때 사용(다르면 처음 발견한 라인번호와 옵셋 출력)
comm : 파일을 비교할 때 사용(한쪽에만 있거나 양쪽 모두에 있는 행 출력)
diff : 파일이 동일한지 여부를 검사
grep : 파일 내 특정 패턴이나 문자열을 검색
find : 파일을 검색할 때 사용
```
---
프로세스 응용
---
> 좀비프로세스<br>
- 프로세스가 수행을 종료했지만, 커널(운영체제)의 오류 또는 부모 프로세스가 종료한 자식 프로세스에 대한 처리오류로 인해 소멸하지않고 남아있는 상태
```
- 시스템 가용성에 문제가 발생할 수 있음
- pa -l 명령 결과로 파악 -> 상태정보필드(S 필드)가 Z로 설정되며, 명령어이름 필드(CMD필드)에 <defunct> 표시가 추가됨
- 제거 방벙 : 좀비 프로세스의 부모 프로세스를 종료시키거나 시스템을 재기동하여 커널 정보를 초기화 (kill명령에도 제거되지 않기에)
```
> 프로세스 관련 식별자<br>
- PID(Process ID) : 커널 내에서 프로세스를 식별하기 위한 고유한 ID
- PPID(Parent Process ID) : 부모 프로세스를 식별하기 위한 ID
> ps<br>
- 시스템에서 동작하는 프로세스 정보를 확인할 때 사용
```
<옵션>
-f : f형식으로 프로세스 정보를 출력
-l : l형식으로 프로세스 정보를 출렷
-e : 현재 시스템에서 동작 중인 모든 프로세스 정보를 출력
* f형식 : UID   PID   PPID   STIME   TTY   TIME   CMD
* l형식 : F   S   UID   PID   PPID   C   PRI   NI   ADDR   SZ   WCHAN   TTY   TIME   CMD
```
> kill<br>
```
<주요 시그널번호>
- 9 : SIGKILL : 무조건 종료
- 19 : SIGSTOP : 무조건 정지
- 15 : SIGTERM : 받은 프로세스는 디폴트로 종료
```

















